<?xml version="1.0" encoding="UTF-8"?>
<Module>
	<ModulePrefs title="单词检测" author="yecol">
		<Require feature="dynamic-height"/>
	</ModulePrefs>
	<UserPref name="height" display_name="高度" default_value="520"
		datatype="enum">
		<EnumValue value="100" display_value="100px" />
		<EnumValue value="300" display_value="300px" />
		<EnumValue value="520" display_value="500px" />
	</UserPref>
	<Content type="html">
<![CDATA[
<style>
.c4{
color:blue;
}
.c6{
color:green;
}
</style>

<script>

function onload()
{
_IG_AdjustIFrameHeight();
}
_IG_RegisterOnloadHandler(onload);

var preurl="http://xujb1987.appspot.com/operate?toCheck=";


function setData(astro)
{
try{

astro=astro.replace(/'/g, " yecols.cn.s");
astro=astro.replace(/"/g, " yecols.cn.d");
//alert("astro:"+astro);
var url=_hesc(preurl+_esc(astro));
//alert(url);
_IG_FetchContent(url, callback);
}
catch(e)
{
alert('文本返回失败.');
}
}
function callback(responseText) {

//alert("backString "+responseText);
responseText=responseText.replace(/ yecols.cn.s/g,"'");
responseText=responseText.replace(/ yecols.cn.d/g,'"');

var indexbegin=responseText.indexOf("<div id='returnArticle'>");
var indexend=responseText.indexOf("<span id='wordsNum4'>");

var index4begin=responseText.indexOf("<span id='wordsNum4'>");
var index4end=responseText.indexOf("<span id='wordsNum6'>");

var index6begin=responseText.indexOf("<span id='wordsNum6'>");
var index6end=responseText.length;

var text=responseText.substring(indexbegin,indexend);
var num4=responseText.substring(index4begin,index4end);
var num6=responseText.substring(index6begin,index6end);


document.myform.article.value="";
document.getElementById('tbhome').innerHTML = "<p align='center'><span class='c4'>蓝色</span>标记四级单词："+num4+"个<br><span class='c6'>绿色</span>标记六级单词："+num6+"个</p>"+text+"<p align='center'><font size=2pt>注意：本工具仅提供参考,单词判定不严格准确。<br>Copyright <a href='http://yecols.cn'>Yecols.cn</a></font></p>";
}


function setMyAstro()
{
var article="";
var boo=false;
if(document.myform.article.value.length>950||document.myform.article.value==""){
alert("输入文本请在1-1000字符以内");
document.myform.article.focus();
}else{
boo=true;}


if(boo){

setData(document.myform.article.value);
}
}
</script>

<body><table border="0" height="__UP_height__">

<center><strong>Mark Words in CET4 or CET6</strong><br><font size=2pt>将文章复制到文本框中，提交后标记其中的四六级单词。</font>
<hr>
</center>
<div align="center">
<form name="myform">
<textarea name="article" style="width:90%" length="5"></textarea><br>

<input type=reset value="清空" name="reset">
<input type=button value="提交" name="submit" onClick="setMyAstro();">
</form>
</div>
<hr>
<div id="tbhome">请在文本框输入英文原文
</div></table>
</body>
]]></Content>
</Module>